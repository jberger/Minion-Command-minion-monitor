<!DOCTYPE html>
<html>
  <head>
    %= stylesheet "https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.5.2/semantic.min.css";
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.5.2/semantic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rivets/0.7.1/rivets.bundled.min.js"></script>
  </head>
  <body>
    <table class="ui celled table">
      <thead><tr>
        % my @cols = qw/id task args state result priority retries created started finished/;
        % for my $col (@cols) {
          <th><%= $col %></th>
        % }
      </tr></thead>
      <tbody>
        <tr rv-each-job="jobs.jobs">
          % for my $col (@cols) {
            <td>
              %== $col eq 'id' ? q[<a rv-href="job.url.web" rv-text="job.id"></a>] : "{ job.$col }"
            </td>
          % }
        </tr>
      </tbody>
    </table>
    %= javascript begin
      var jobs = {jobs: []};
      rivets.bind($('tbody'), {jobs: jobs});
      function refresh () {
        $.get("<%= url_for 'api_jobs' %>", function(data) {
          jobs.jobs = data;
        });
      }
      $(refresh);
    % end
  </body>
</htmL>
